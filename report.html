<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>RustQC Report for test-3.fastq</title>

  <!-- Fonts and uPlot -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uplot@1.6.26/dist/uPlot.min.css">
  <script src="https://cdn.jsdelivr.net/npm/uplot@1.6.26/dist/uPlot.iife.min.js"></script>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #f5f7fa;
      padding: 1em;
      display: flex;
      color: #333;
    }

    main {
      width: 75%;
    }

    .card {
      background: white;
      padding: 2em;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 2em;
      margin-bottom: 0.5em;
    }

    h2 {
      margin-top: 2.5em;
      font-size: 1.4em;
      border-bottom: 2px solid #eee;
      padding-bottom: 0.2em;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 2em;
      border: 1px solid #b69292;
      background-color: #fff;
      border-radius: 6px;
      overflow: hidden;
    }

    th {
      background-color: #fafafa;
      font-weight: 600;
      color: #333;
    }

    td, th {
      padding: 12px 16px;
      border-bottom: 1px solid #eee;
    }

    .plot-container {
      margin: 1em auto;
      max-width: 1100px;
    }

    #toc {
      position: sticky;
      top: 2em;
      margin-left: 2em;
      padding: 1em 1.5em;
      background: #fff;
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      width: 220px;
      font-size: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    }

    #toc h3 {
      margin-top: 0;
      font-size: 16px;
      color: #333;
    }

    #toc ul {
      list-style: none;
      padding-left: 0;
    }

    #toc li {
      margin-bottom: 0.5em;
    }

    #toc a {
      text-decoration: none;
      color: #3498db;
    }

    #toc a:hover {
      text-decoration: underline;
    }

    small {
      display: block;
      margin-top: 0.5em;
      color: #777;
    }
  </style>
</head>

<body>

<main class="card">
    <h1>RustQC Report</h1>
    <p><strong>Generated by:</strong> shakilrafi on 2025-06-06 21:27:08</p>
    <h2 id="basic-stats">Basic Statistics</h2>
    <table>
        <tr><th>Filename</th><td>test-3.fastq</td></tr>
        <tr><th>Total Reads</th><td>25000</td></tr>
        <tr><th>Average Read Length</th><td>101</td></tr>
        <tr><th>Minimum Read Length</th><td>101</td></tr>
        <tr><th>Maximum Read Length</th><td>101</td></tr>
        <tr><th>Mode Read Length</th><td>101</td></tr>
        <tr><th>GC Content (%)</th><td>43</td></tr>
    </table>

    <div class="plot-container">
        <h2 id="per-base-quality">Per-Base Quality</h2>
        <div id="per-base-plot" style="width:100%; height:400px;"></div>
        <small>Drag to zoom. Double-click to reset.</small>
    </div>

    <div class="plot-container">
        <h2 id="read-length-hist">Read Length Histogram</h2>
        <div id="length-hist" style="width:100%; height:400px;"></div>
        <small>Distribution of read lengths.</small>
    </div>

    <div class="plot-container">
        <h2 id="gc-percent-hist">GC Content Per Read</h2>
        <div id="gc-hist" style="width:100%; height:400px;"></div>
        <small>Each bin represents a %GC range.</small>
    </div>

    <div class="plot-container">
        <h2 id="base-composition">Per-Base Sequence Content</h2>
        <div id="base-comp-plot" style="width:100%; height:400px;"></div>
        <small>% of A/T/G/C at each base position.</small>
    </div>


    <div class="plot-container">
        <h2 id="per-seq-qual">Per-Sequence Quality Scores</h2>
        <div id="per-seq-quality-chart" style="width:100%; height:400px;"></div>
        <small>Average quality score per read.</small>
    </div>

    <div class="plot-container">
        <h2 id="n-content">Per-Base N Content</h2>
        <div id="n-content-plot" style="width:200%; height:400px;"></div>
        <small>Percentage of ambiguous bases (N) per position.</small>
    </div>


</main>


<nav id="toc">
  <h3>Contents</h3>
  <ul>
    <li><a href="#basic-stats">Basic Statistics</a></li>
    <li><a href="#per-base-quality">Per-Base Quality</a></li>
    <li><a href="#read-length-hist">Read Length Histogram</a></li>
    <li><a href="#gc-percent-hist">GC Content Histogram</a></li>
    <li><a href="#base-composition">Base Composition</a></li>
    <li><a href="#per-seq-qual">Per-Sequence Quality</a></li>
    <li><a href="#n-content">Per-Base N Content</a></li>
  </ul>
</nav>

<script>
  // Base positions
  const pos = 101;
  const basePos = [...Array(pos).keys()].map(i => i + 1);

  // Per-base quality
  const qualities = [65.12064,65.179,65.24992,68.83272,68.8428,68.83968,68.84176,68.93624,70.57476,70.61664,70.71464,70.5198,70.68932,72.14832,72.17776,72.11616,72.13448,72.0994,72.09544,72.15704,72.11404,72.1306,72.0024,72.03252,72.0524,71.87528,71.99112,71.7036,71.7424,71.86864,71.79728,71.86496,71.736,71.80192,71.58764,71.6126,71.40072,71.52616,71.3662,71.39576,71.34428,71.03004,71.14236,71.20084,71.14408,70.92092,70.79252,70.68808,70.6908,70.49012,70.11496,70.27596,70.35076,70.40296,70.3156,70.26552,70.10736,70.0072,70.19208,70.12188,70.24068,70.16664,70.2884,70.16544,70.07528,69.98936,69.77716,69.68692,69.57232,69.29808,69.26432,69.0954,68.97976,68.83456,68.68776,68.2862,68.23216,68.14892,67.86848,67.68796,67.55604,67.42896,67.31936,67.11032,66.91784,66.75888,66.7906,66.75148,66.6934,66.66676,66.57368,66.4986,66.36664,66.10704,66.23372,66.14044,66.21936,66.09568,66.11036,66.0022,65.51188];
  new uPlot({
    title: "Per-Base Mean Quality Score",
    width: 1000,
    height: 400,
    legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
    },
    series: [
      { label: "Base", value: (u,v)=>`${v}` },
      { label: "Quality", stroke: "steelblue", width: 2, value: (u,v)=>v.toFixed(2) }
    ],
    axes: [
      { label: "Base Position", time: false, values: (u,t)=>t.map(v=>v.toFixed(0)) },
      { label: "Mean Quality", range: [0, 45] }
    ],
    cursor: { drag: { x: true, y: false } },
    hooks: { ready: [u => u.root.addEventListener("dblclick", () => u.setScale("x", null))] }
  }, [basePos, qualities], document.getElementById("per-base-plot"));

  // Read length histogram
  const readLenHist = {"101":25000};
  const lenBins = Object.entries(readLenHist).map(([l,c]) => [parseInt(l), c]).sort((a,b)=>a[0]-b[0]);
  const xLen = lenBins.map(([l,_]) => l);
  const yLen = lenBins.map(([_,c]) => c);

  new uPlot({
  title: "Read Length Histogram",
  width: 1000,
  height: 400,
  legend: {
    show: true,
    live: true
  },
  series: [
    { label: "Length", value: (u,v)=>`Length: ${v}` },
    { label: "Count", stroke: "steelblue", width: 2, fill: "rgba(70,130,180,0.3)", value: (u,v)=>v.toFixed(0) }
  ],
  axes: [
    {
      label: "Read Length",
      time: false,
      values: (u, t) => t.map(v => v.toFixed(0))
    },
    {
      label: "Count"
    }
  ],
  cursor: { drag: { x: true, y: false } },
  hooks: {
    ready: [
      u => {
        u.root.addEventListener("dblclick", () => u.setScale("x", null));

        // ðŸ‘‡ Inject CSS to rotate X-axis labels
        const style = document.createElement("style");
        style.innerHTML = `
          .uplot .xticks > div {
            transform: rotate(-45deg);
            transform-origin: top right;
            white-space: nowrap;
          }
        `;
        document.head.appendChild(style);
      }
    ]
  }
}, [xLen, yLen], document.getElementById("length-hist"));


  // GC% histogram
  const gcHist = {"0":22,"1":9,"10":6,"11":9,"12":3,"13":9,"14":2,"15":8,"16":8,"17":16,"18":32,"19":34,"2":12,"20":67,"21":99,"22":131,"23":154,"24":161,"25":205,"26":269,"27":339,"28":406,"29":480,"3":7,"30":496,"31":602,"32":642,"33":694,"34":720,"35":786,"36":760,"37":855,"38":918,"39":883,"4":10,"40":963,"41":903,"42":864,"43":872,"44":755,"45":729,"46":716,"47":665,"48":652,"49":600,"5":12,"50":1181,"51":504,"52":458,"53":460,"54":435,"55":469,"56":429,"57":390,"58":366,"59":393,"6":5,"60":310,"61":314,"62":263,"63":226,"64":219,"65":164,"66":158,"67":121,"68":107,"69":79,"7":2,"70":84,"71":53,"72":37,"73":33,"74":28,"75":15,"76":24,"77":11,"78":16,"79":10,"8":4,"80":11,"81":7,"82":5,"83":3,"84":3,"85":3,"86":1,"87":3,"89":1,"9":4,"90":1,"92":1,"93":1,"94":1,"95":1,"98":1};
  const gcBins = Object.entries(gcHist).map(([g,c]) => [parseInt(g), c]).sort((a,b) => a[0] - b[0]);
  const xGC = gcBins.map(([g,_]) => g);
  const yGC = gcBins.map(([_,c]) => c);

  new uPlot({
    title: "GC Content Per Read",
    width: 1000,
    height: 400,
    legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
    },
    series: [
      { label: "GC %", value: (u,v)=>`${v}` },
      { label: "Count", stroke: "steelblue", width: 2, fill: "rgba(70, 130, 180, 0.3)", value: (u,v)=>v.toFixed(0) }
    ],
    axes: [
      { label: "GC %", time: false, values: (u,t)=>t.map(v=>v.toFixed(0)) },
      { label: "Count" }
    ],
    cursor: { drag: { x: true, y: false } },
    hooks: { ready: [u => u.root.addEventListener("dblclick", () => u.setScale("x", null))] }
  }, [xGC, yGC], document.getElementById("gc-hist"));

  // Base composition
  const A = [33.864,32.024,31.336000000000002,29.824,29.299999999999997,29.272,28.24,28.732000000000003,28.183999999999997,28.327999999999996,28.652,28.704,28.748,28.516000000000002,29.052,28.236,28.416000000000004,28.236,28.939999999999998,28.267999999999997,28.544000000000004,28.427999999999997,28.227999999999998,28.436,28.816000000000003,28.327999999999996,28.18,28.092,29.004,27.872000000000003,28.427999999999997,28.427999999999997,28.216,28.536,27.988000000000003,28.42,27.711999999999996,28.436,28.34,28.011999999999997,27.792,28.096,27.764,28.139999999999997,28.16,27.848,28.504,27.58,27.988000000000003,28.383999999999997,28.552,28.832,28.355999999999998,27.836,28.212,27.688000000000002,27.748,28.292,27.92,28.248,27.948,28.24,28.168,28.368,28.124,27.42,27.708,28.067999999999998,28.199999999999996,27.968,27.800000000000004,27.732,27.376,27.1,27.996,28.195999999999998,27.548000000000002,28.036,27.683999999999997,27.748,27.808,27.683999999999997,28.076,27.567999999999998,27.951999999999998,27.636,28.248,27.752,28.023999999999997,28.083999999999996,28.232000000000003,27.708,27.6,27.964,27.604,27.492,27.892,27.284000000000002,25.747999999999998,20.072000000000003,0.0];
  const T = [24.868000000000002,29.415999999999997,29.427999999999997,29.124,27.811999999999998,25.824,27.876,27.412,28.267999999999997,27.976,28.308,28.584,29.136,29.024,28.355999999999998,29.204,28.908,28.267999999999997,28.336,28.555999999999997,28.492,28.448,28.212,28.664,28.508,27.932000000000002,28.424,28.316000000000003,28.352,28.772,28.352,28.232000000000003,28.456,27.936,28.16,28.156,28.327999999999996,28.044000000000004,27.804000000000002,28.68,28.212,28.28,28.02,28.04,28.396,28.116000000000003,27.860000000000003,28.016000000000002,27.932000000000002,28.195999999999998,27.36,27.552,27.96,28.124,28.104000000000003,27.788,28.004,27.848,27.848,27.927999999999997,27.6,27.656,27.804000000000002,27.339999999999996,28.1,27.972,27.832,27.804000000000002,27.564,27.444000000000003,27.424,27.748,27.776,28.1,27.62,28.004,27.404,27.644000000000002,27.744000000000003,27.728,27.339999999999996,28.048000000000002,27.004,28.072000000000003,27.816000000000003,27.800000000000004,27.692,27.964,27.76,27.556000000000004,28.195999999999998,27.651999999999997,28.288000000000004,27.796,27.88,28.299999999999997,27.128000000000004,27.636,27.716,27.700000000000003,27.496];
  const G = [23.216,20.392,20.712,21.68,21.732000000000003,21.912000000000003,21.92,21.256,21.236,21.54,20.84,21.248,21.04,20.952,20.924,21.088,21.384,21.58,21.368000000000002,21.864,21.312,21.568,21.523999999999997,20.884,21.268,21.92,21.44,21.62,20.812,21.3,21.8,21.792,21.715999999999998,21.572,21.708,21.732000000000003,21.831999999999997,21.488,21.895999999999997,21.604,22.024,21.872,22.248,21.808,21.768,22.024,21.68,22.220000000000002,21.856,21.688,22.144,21.544,21.784,21.656,21.484,22.148,22.284000000000002,21.68,21.504,21.672,21.892,21.496000000000002,21.932,21.648,21.444,21.732000000000003,21.948,21.784,21.464,22.12,22.076,22.38,22.1,22.128,21.736,21.471999999999998,22.451999999999998,21.54,21.712,21.944,22.268,21.82,22.416,22.108,21.759999999999998,22.448,22.2,22.3,22.2,21.756,21.744,22.016,22.116,21.887999999999998,21.996,21.956,22.444,21.928,21.532,19.932,14.832];
  const C = [16.864,17.348,17.784,18.64,20.436,22.42,21.407999999999998,22.092,21.868000000000002,21.708,21.932,21.048000000000002,20.692,21.152,21.308,21.14,20.979999999999997,21.584,21.044,21.024,21.372,21.352,21.812,21.823999999999998,21.2,21.612000000000002,21.759999999999998,21.728,21.584,21.828,21.132,21.304000000000002,21.304000000000002,21.644,21.831999999999997,21.296,21.784,21.712,21.548000000000002,21.348,21.616,21.42,21.644,21.68,21.404,21.732000000000003,21.68,21.892,21.895999999999997,21.376,21.58,21.676000000000002,21.484,21.964,21.764,21.924,21.492,21.676000000000002,22.195999999999998,21.636,22.0,22.044,21.468,22.008,21.692,22.172,21.86,21.624,22.040000000000003,21.715999999999998,21.956,21.392,21.976000000000003,21.904,21.88,21.556,21.831999999999997,22.048000000000002,22.144,21.944,21.956,21.872,21.932,21.752,22.008,21.684,21.432000000000002,21.592,21.632,22.228,21.448,22.244,21.656,22.032,22.220000000000002,21.968,22.152,22.296,21.932,22.224,22.112000000000002];

  new uPlot({
  title: "Per-Base Sequence Content",
  width: 1000,
  height: 400,
  legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
  },
  series: [
    { label: "Position" },
    { label: "%A", stroke: "#1f77b4", width: 2, show: true },
    { label: "%T", stroke: "#d62728", width: 2, show: true },
    { label: "%G", stroke: "#2ca02c", width: 2, show: true },
    { label: "%C", stroke: "#ff7f0e", width: 2, show: true }
  ],
  axes: [
    { label: "Base Position", time: false, scale: "x", values: (u,t)=>t.map(v=>v.toFixed(0)) },
    { label: "Percentage", scale: "y", range: [0, 100] }
  ],
  cursor: { drag: { x: true, y: false } },
  hooks: {
    ready: [u => {
      u.root.addEventListener("dblclick", () => {
        u.setScale("x", null);
        u.setScale("y", null);
      });
    }]
  }
}, [basePos, A, T, G, C], document.getElementById("base-comp-plot"));

// Per-sequence quality histogram
const psqHist = {"36":21,"37":22,"38":11,"39":10,"40":6,"41":5,"42":12,"43":21,"44":21,"45":30,"46":35,"47":27,"48":24,"49":30,"50":35,"51":42,"52":55,"53":52,"54":57,"55":60,"56":100,"57":93,"58":114,"59":122,"60":161,"61":173,"62":204,"63":222,"64":313,"65":404,"66":566,"67":746,"68":1071,"69":1705,"70":3154,"71":6157,"72":7840,"73":1279};
const psqBins = Object.entries(psqHist).map(([q, c]) => [parseInt(q), c]).sort((a, b) => a[0] - b[0]);
const xPSQ = psqBins.map(([q, _]) => q);
const yPSQ = psqBins.map(([_, c]) => c);

new uPlot({
  title: "Per-Sequence Quality Score Distribution",
  width: 1000,
  height: 400,
  legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
  },
  series: [
    { label: "Quality Score", value: (u, v) => `${v}` },
    {
      label: "Count",
      stroke: "darkorchid",
      width: 2,
      fill: "rgba(153, 50, 204, 0.3)",
      value: (u, v) => v.toFixed(0)
    }
  ],
  axes: [
    { label: "Average Quality", time: false, values: (u, vals) => vals.map(v => v.toFixed(0)) },
    { label: "Read Count" }
  ],
  cursor: { drag: { x: true, y: false } },
  hooks: {
    ready: [u => u.root.addEventListener("dblclick", () => u.setScale("x", null))]
  }
}, [xPSQ, yPSQ], document.getElementById("per-seq-quality-chart"));

const nContent = [1.188,0.8200000000000001,0.74,0.732,0.72,0.5720000000000001,0.5559999999999999,0.508,0.44400000000000006,0.44799999999999995,0.268,0.416,0.384,0.356,0.36,0.332,0.312,0.332,0.312,0.28800000000000003,0.27999999999999997,0.20400000000000001,0.22399999999999998,0.192,0.208,0.208,0.196,0.244,0.248,0.22799999999999998,0.28800000000000003,0.244,0.308,0.312,0.312,0.396,0.344,0.32,0.41200000000000003,0.356,0.356,0.332,0.32399999999999995,0.332,0.272,0.27999999999999997,0.27599999999999997,0.292,0.328,0.356,0.364,0.396,0.416,0.42,0.436,0.45199999999999996,0.47200000000000003,0.504,0.532,0.516,0.5599999999999999,0.5640000000000001,0.628,0.636,0.64,0.7040000000000001,0.652,0.72,0.732,0.752,0.744,0.748,0.772,0.768,0.768,0.772,0.764,0.732,0.716,0.636,0.628,0.5760000000000001,0.5720000000000001,0.5,0.464,0.432,0.428,0.392,0.384,0.376,0.38,0.38,0.33999999999999997,0.32,0.3,0.28400000000000003,0.384,0.856,3.072,10.072000000000001,35.56];

new uPlot({
  title: "Per-Base N Content",
  width: 1000,
  height: 400,
  legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
  },
  series: [
    { label: "Position" },
    { label: "%N", stroke: "purple", width: 2, value: (u,v)=>v.toFixed(2) }
  ],
  axes: [
    { label: "Base Position", time: false, values: (u,t)=>t.map(v=>v.toFixed(0)) },
    { label: "% N", range: [0, 100] }
  ],
  cursor: { drag: { x: true, y: false } },
  hooks: { ready: [u => u.root.addEventListener("dblclick", () => u.setScale("x", null))] }
}, [basePos, nContent], document.getElementById("n-content-plot"));




</script>

</body>
</html>
