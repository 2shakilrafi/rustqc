<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>RustQC Report for test-2.fastq.gz</title>

  <!-- Fonts and uPlot -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/uplot@1.6.26/dist/uPlot.min.css">
  <script src="https://cdn.jsdelivr.net/npm/uplot@1.6.26/dist/uPlot.iife.min.js"></script>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #f5f7fa;
      padding: 1em;
      display: flex;
      color: #333;
    }

    main {
      width: 75%;
    }

    .card {
      background: white;
      padding: 2em;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 2em;
      margin-bottom: 0.5em;
    }

    h2 {
      margin-top: 2.5em;
      font-size: 1.4em;
      border-bottom: 2px solid #eee;
      padding-bottom: 0.2em;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 2em;
      border: 1px solid #b69292;
      background-color: #fff;
      border-radius: 6px;
      overflow: hidden;
    }

    th {
      background-color: #fafafa;
      font-weight: 600;
      color: #333;
    }

    td, th {
      padding: 12px 16px;
      border-bottom: 1px solid #eee;
    }

    .plot-container {
      margin: 1em auto;
      max-width: 1100px;
    }

    #toc {
      position: sticky;
      top: 2em;
      margin-left: 2em;
      padding: 1em 1.5em;
      background: #fff;
      border: 1px solid #e0e0e0;
      border-radius: 10px;
      width: 220px;
      font-size: 14px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    }

    #toc h3 {
      margin-top: 0;
      font-size: 16px;
      color: #333;
    }

    #toc ul {
      list-style: none;
      padding-left: 0;
    }

    #toc li {
      margin-bottom: 0.5em;
    }

    #toc a {
      text-decoration: none;
      color: #3498db;
    }

    #toc a:hover {
      text-decoration: underline;
    }

    small {
      display: block;
      margin-top: 0.5em;
      color: #777;
    }
  </style>
</head>

<body>

<main class="card">
    <h1>RustQC Report</h1>
    <p><strong>Generated by:</strong> shakilrafi on 2025-06-17 22:45:24</p>
    <h2 id="basic-stats">Basic Statistics</h2>
    <table>
        <tr><th>Filename</th><td>test-2.fastq.gz</td></tr>
        <tr><th>Total Reads</th><td>127061</td></tr>
        <tr><th>Average Read Length</th><td>150</td></tr>
        <tr><th>Minimum Read Length</th><td>150</td></tr>
        <tr><th>Maximum Read Length</th><td>150</td></tr>
        <tr><th>Mode Read Length</th><td>150</td></tr>
        <tr><th>GC Content (%)</th><td>35</td></tr>
    </table>

    <div class="plot-container">
        <h2 id="per-base-quality">Per-Base Quality</h2>
        <div id="per-base-plot" style="width:100%; height:400px;"></div>
        <small>Drag to zoom. Double-click to reset.</small>
    </div>

    <div class="plot-container">
        <h2 id="read-length-hist">Read Length Histogram</h2>
        <div id="length-hist" style="width:100%; height:400px;"></div>
        <small>Distribution of read lengths.</small>
    </div>

    <div class="plot-container">
        <h2 id="gc-percent-hist">GC Content Per Read</h2>
        <div id="gc-hist" style="width:100%; height:400px;"></div>
        <small>Each bin represents a %GC range.</small>
    </div>

    <div class="plot-container">
        <h2 id="base-composition">Per-Base Sequence Content</h2>
        <div id="base-comp-plot" style="width:100%; height:400px;"></div>
        <small>% of A/T/G/C at each base position.</small>
    </div>


    <div class="plot-container">
        <h2 id="per-seq-qual">Per-Sequence Quality Scores</h2>
        <div id="per-seq-quality-chart" style="width:100%; height:400px;"></div>
        <small>Average quality score per read.</small>
    </div>

    <div class="plot-container">
        <h2 id="n-content">Per-Base N Content</h2>
        <div id="n-content-plot" style="width:200%; height:400px;"></div>
        <small>Percentage of ambiguous bases (N) per position.</small>
    </div>

    <div class="plot-container">
      <h2 id="overrep">Overrepresented Sequences</h2>
      
        <table>
          <thead>
            <tr>
              <th>Sequence</th>
              <th>Percentage of Reads</th>
              <th>Count</th>
            </tr>
          </thead>
          <tbody>
            
            <tr>
              <td><code>GATCGGAAGA</code></td>
              <td>2%</td>
              <td>2415</td>
            </tr>
            
            <tr>
              <td><code>CCCTACACGA</code></td>
              <td>0%</td>
              <td>281</td>
            </tr>
            
          </tbody>
        </table>
        <small>Sequences appearing in more than 0.1% of total reads.</small>
      
    </div>


</main>


<nav id="toc">
  <h3>Contents</h3>
  <ul>
    <li><a href="#basic-stats">Basic Statistics</a></li>
    <li><a href="#per-base-quality">Per-Base Quality</a></li>
    <li><a href="#read-length-hist">Read Length Histogram</a></li>
    <li><a href="#gc-percent-hist">GC Content Histogram</a></li>
    <li><a href="#base-composition">Base Composition</a></li>
    <li><a href="#per-seq-qual">Per-Sequence Quality</a></li>
    <li><a href="#n-content">Per-Base N Content</a></li>
    <li><a href="#overrep">Overrepresented Sequences</a></li>
  </ul>
</nav>

<script>
  // Base positions
  const pos = 150;
  const basePos = [...Array(pos).keys()].map(i => i + 1);

  // Per-base quality
  const qualities = [64.22399477416359,64.33099062654945,68.13573795263692,68.87164432831474,69.05868047630666,72.36775249683222,72.67414863726871,72.76599428620898,72.78814899929955,72.83137233297393,72.841123554828,72.85813113386483,72.85042617325537,72.81942531539968,72.79930899331816,72.78981748923745,72.7557078883371,72.7537875508614,72.7542361542881,72.72777642234833,72.72455749600586,72.72809123177056,72.70690455765342,72.6539772235383,72.64336814600861,72.5507748246905,72.47357568412022,72.47818764215613,72.46230550680382,72.42004234186729,72.42216730546745,72.40407363392386,72.37872360519751,72.39603025318547,72.36137760603175,72.33697200557212,72.32814160127812,72.31724919526842,72.30744288176545,72.27028749970486,72.09851173845634,72.09547382753166,72.11266242198629,72.14014528454837,72.16891886574165,72.12537285240947,72.06343409858258,72.0355183730649,72.02912774179332,71.96615798710856,71.93650293953299,71.95572992499666,71.89859988509455,71.84906462250414,71.82055075908421,71.80517231880751,71.85153587646879,71.80740746570545,71.79765624385138,71.81209025586136,71.73807069045577,71.74930938682995,71.76740305837353,71.7238491748058,71.61075388986393,71.62156759351808,71.6315785331455,71.68344338546052,71.67279495675305,71.67739117431785,71.69038493322105,71.69912089468838,71.66726218115708,71.50485200022037,71.4282982189657,71.37437923517051,70.26505379306002,70.92143143844295,71.18652458268076,71.2746239994963,71.30990626549453,71.32569395802017,71.28421781663926,71.24372545470285,71.25545997591708,71.22504938572811,71.1520923021226,71.1666128867237,71.16555827515917,71.14744886314448,71.15993892697209,71.15993892697209,71.16064724817214,71.14747247385114,71.15587788542511,71.16991051542173,71.12817465626746,70.99634034046639,70.94352318964907,70.89718324269445,70.85166180023768,70.78862908366847,70.80817087855439,70.83404034282746,70.8534719544156,70.84701836125956,70.83929766017897,70.77894082369885,70.75792729476393,70.70372498248872,70.69258859917677,70.65840029592086,70.64922360126239,70.62430643549162,70.55104241269942,70.50245157837574,70.42038863223176,70.39301595296747,70.3997764853102,70.29861247747145,70.30141428132944,70.23376173648877,70.17965386704024,70.12856816804526,70.03958728484744,69.99381399485287,69.93992649199991,69.85595107861579,69.80296078261622,69.73955029474033,69.6951700364392,69.63389238239901,69.56172232234911,69.46712996119975,69.41883032559164,69.30881230275222,69.26129969069974,69.17466413769765,69.10516208750128,69.04366406686552,68.92620080118998,68.81447493723488,68.76347581083103,68.69772786299494,68.6242906950205,68.56339081228701,68.40383752685717,68.39755707888337,68.36616270924989,65.20070674715294];
  new uPlot({
    title: "Per-Base Mean Quality Score",
    width: 1000,
    height: 400,
    legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
    },
    series: [
      { label: "Base", value: (u,v)=>`${v}` },
      { label: "Quality", stroke: "steelblue", width: 2, value: (u,v)=>v.toFixed(2) }
    ],
    axes: [
      { label: "Base Position", time: false, values: (u,t)=>t.map(v=>v.toFixed(0)) },
      { label: "Mean Quality", range: [0, 45] }
    ],
    cursor: { drag: { x: true, y: false } },
    hooks: { ready: [u => u.root.addEventListener("dblclick", () => u.setScale("x", null))] }
  }, [basePos, qualities], document.getElementById("per-base-plot"));

  // Read length histogram
  const readLenHist = {"150":127061};
  const lenBins = Object.entries(readLenHist).map(([l,c]) => [parseInt(l), c]).sort((a,b)=>a[0]-b[0]);
  const xLen = lenBins.map(([l,_]) => l);
  const yLen = lenBins.map(([_,c]) => c);

  new uPlot({
  title: "Read Length Histogram",
  width: 1000,
  height: 400,
  legend: {
    show: true,
    live: true
  },
  series: [
    { label: "Length", value: (u,v)=>`Length: ${v}` },
    { label: "Count", stroke: "steelblue", width: 2, fill: "rgba(70,130,180,0.3)", value: (u,v)=>v.toFixed(0) }
  ],
  axes: [
    {
      label: "Read Length",
      time: false,
      values: (u, t) => t.map(v => v.toFixed(0))
    },
    {
      label: "Count"
    }
  ],
  cursor: { drag: { x: true, y: false } },
  hooks: {
    ready: [
      u => {
        u.root.addEventListener("dblclick", () => u.setScale("x", null));

        // ðŸ‘‡ Inject CSS to rotate X-axis labels
        const style = document.createElement("style");
        style.innerHTML = `
          .uplot .xticks > div {
            transform: rotate(-45deg);
            transform-origin: top right;
            white-space: nowrap;
          }
        `;
        document.head.appendChild(style);
      }
    ]
  }
}, [xLen, yLen], document.getElementById("length-hist"));


  // GC% histogram
  const gcHist = {"0":3,"1":1,"10":35,"100":1,"11":145,"12":88,"13":233,"14":134,"15":410,"16":250,"17":724,"18":448,"19":1202,"2":2,"20":695,"21":1762,"22":1042,"23":2441,"24":1511,"25":3613,"26":2084,"27":5018,"28":2860,"29":6375,"3":7,"30":3508,"31":7473,"32":4017,"33":8237,"34":4130,"35":8393,"36":4176,"37":8150,"38":3838,"39":7212,"4":1,"40":3324,"41":6165,"42":2741,"43":4947,"44":2257,"45":3977,"46":1653,"47":2765,"48":1134,"49":1987,"5":16,"50":801,"51":1366,"52":540,"53":858,"54":347,"55":492,"56":206,"57":353,"58":131,"59":224,"6":15,"60":99,"61":111,"62":58,"63":64,"64":27,"65":25,"66":19,"67":22,"68":10,"69":13,"7":18,"70":3,"71":2,"72":1,"73":3,"75":1,"79":2,"8":12,"82":1,"9":51,"99":1};
  const gcBins = Object.entries(gcHist).map(([g,c]) => [parseInt(g), c]).sort((a,b) => a[0] - b[0]);
  const xGC = gcBins.map(([g,_]) => g);
  const yGC = gcBins.map(([_,c]) => c);

  new uPlot({
    title: "GC Content Per Read",
    width: 1000,
    height: 400,
    legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
    },
    series: [
      { label: "GC %", value: (u,v)=>`${v}` },
      { label: "Count", stroke: "steelblue", width: 2, fill: "rgba(70, 130, 180, 0.3)", value: (u,v)=>v.toFixed(0) }
    ],
    axes: [
      { label: "GC %", time: false, values: (u,t)=>t.map(v=>v.toFixed(0)) },
      { label: "Count" }
    ],
    cursor: { drag: { x: true, y: false } },
    hooks: { ready: [u => u.root.addEventListener("dblclick", () => u.setScale("x", null))] }
  }, [xGC, yGC], document.getElementById("gc-hist"));

  // Base composition
  const A = [35.26180338577534,35.93943066715987,32.801567750922786,31.548626250383677,31.9271845806345,31.931119698412573,34.21033991547367,33.68933032165653,31.3038619245874,34.054509251461894,31.86658376685214,32.15856950598531,34.14265588969078,32.09009845664681,34.1332116070234,32.01533121886338,31.919314345078348,31.84533413085054,31.935841839746264,31.839824965961235,32.186902353987456,33.79243040744209,33.81525409055493,31.86186162551845,31.91537922730027,32.44268500956234,31.753252374843576,33.08725730161104,32.05546942019974,31.821723424182085,32.76929978514257,33.84043884433461,31.661957642392235,33.833355632334076,31.92088839218958,31.945286122413645,32.72680051313936,31.738298927286895,33.97974201367847,33.08568325449981,31.86343567262968,32.04130299619868,32.043664066865524,31.959452546414713,31.85713948418476,32.46629571623079,34.08441614657527,31.722558456174593,31.604504922832337,31.724132503285823,31.867370790407755,32.16880081220831,31.93662886330188,31.675337042837693,32.03815490197622,32.45291631578533,31.71547524417406,32.581988178906194,31.850056272184226,31.837463895294388,32.07829310331258,31.84769520151738,32.481249163787474,33.78613421899718,32.931426637599266,33.031378629162376,32.97943507449178,33.0274435113843,33.08410920738858,33.32808650962924,33.88451216344905,32.865316658927604,33.02350839360622,32.74805014914096,33.14077490339286,32.711847065582674,32.524535459346296,32.301807793107244,32.47652702245378,32.58277520246181,32.30102076955163,32.56388663712705,32.34588111222168,32.28291922777249,32.581988178906194,32.07278393842328,32.45763845711902,33.05656338294205,32.96054650915702,32.91411211937573,32.61110805046395,32.925130449154345,32.80392882158963,32.949528179378405,33.20531083495329,32.848789164259685,32.838557858036694,32.593793532240426,32.82045631625755,32.53083164779122,32.48046214023186,32.58671032023989,32.655181369578386,32.467869763342016,32.52610950645753,32.50722094112277,32.411204067337735,32.45291631578533,32.591432461573575,32.37657503089068,32.34430706511046,32.44268500956234,32.62370042735379,32.558377472237744,32.47652702245378,32.590645438017965,32.64337601624417,32.548146166014746,32.64731113402224,32.52768355356876,32.61976530957572,32.46393464556394,32.42143537356073,32.293937557551104,32.53712783623614,32.46865678689763,32.51981331801261,32.47888809312063,32.30259481666286,32.38916740778052,32.29157648688425,32.227040555323825,32.4356017975618,32.42379644422758,32.53712783623614,32.78582727981048,32.52689653001315,32.511943082456455,32.44740715089603,32.448194174451636,32.46550869267517,32.4773140460094,32.31676124066393,32.45763845711902,32.36555670111206,32.25301233265911,32.37972312511314,32.164078670874616,32.41513918511581,32.48597130512116];
  const T = [29.267831986211345,31.98227622952755,35.00523370664484,32.67957909980246,31.888620426409364,31.50140483704677,31.27395502947403,32.01297014819654,32.4041208553372,31.833528777516314,31.6233934881671,31.61709729972218,31.746956186398663,32.05783049086659,31.938989933968724,31.9484342166361,32.33643682955431,33.79951361944263,31.963387664192787,33.81210599633247,31.802834858847323,32.12944963442756,31.935841839746264,32.02634954864199,33.262763554513185,32.007460983307226,32.81179905714578,31.93977695752434,31.78630736417941,33.11952526739125,31.893342567743055,31.99959074775108,31.9169532744115,32.01297014819654,31.79496462329118,32.869251776705674,33.02429541716184,31.871305908185832,31.867370790407755,31.854778413517913,32.85665939981583,32.578053061128124,32.82596548114685,32.541062954014215,31.81778830640401,33.07309087760997,31.751678327732346,33.17382989272869,32.58041413179497,31.79653867040241,32.20185580154414,32.21680924910083,33.028230534939915,32.38680633711367,32.99438852204846,32.798419656700325,31.848482225072992,33.109293961168255,31.972044923304555,32.66147755802331,33.68618222743407,32.93536175537734,31.93505481619065,31.927971604190112,32.45685143356341,32.00195181841792,32.518239270901375,32.0318587135313,31.825658541960163,32.42694453845004,31.879176143741983,32.58907139090673,31.923249462856422,32.033432760642526,31.63283777083448,31.97283194686017,32.34902920644414,32.3726399131126,32.68902338246984,32.5457850953479,32.05232132597728,32.46314762200833,31.968896829082095,32.21208710776713,32.49462856423293,32.68115314691369,32.0948205979805,31.79181652906872,32.1003297628698,31.810705094403474,32.260882568215266,32.18296723620938,31.955517428636636,31.897277685521132,31.827232589071393,32.26009554465965,32.040515972643064,31.888620426409364,31.8697318610746,31.960239569970327,32.28764136910618,31.891768520631825,32.37893610155752,32.19162449532115,31.821723424182085,32.224679484656974,31.86028757840722,32.18611533043184,32.040515972643064,32.101116786425415,32.04917323175482,32.000377771306695,32.174309977097614,32.05625644375536,32.04209001975429,32.02792359575322,31.986211347305627,32.11685725753772,32.168013788652694,31.92010136863396,31.9901464650837,31.92403648641204,32.107412974870336,31.97283194686017,31.834315801071927,31.85871353129599,31.98699837086124,32.0633396557559,32.014544195307764,31.93190672196819,32.0113961010853,31.8539913899623,31.79496462329118,31.901999826854816,31.817001282848395,31.533672802826988,31.702882867284217,31.97283194686017,31.570662909940893,31.72491952684144,31.72649357395267,31.77843712862326,31.935841839746264,31.61867134683341,32.003525865529156,31.756400469066037,31.741447021509355,31.938989933968724,31.689503466838765,31.557283509495438];
  const G = [18.830325591644957,17.776501050676448,15.606677107845837,16.70929710926248,19.079025035219306,18.868889745870092,17.65923454088981,16.801378865269438,18.85708439253587,16.963505717726132,18.95782340765459,17.061096638622395,16.88637740927586,16.83915599593896,16.757305546154996,16.872998008830404,18.63750482051928,16.933598822612762,16.882442291497785,17.204334925744327,18.71935527030324,16.935959893279605,16.976885118171587,16.976885118171587,17.606503962663602,17.131928758627744,17.242899079969465,16.972162976837897,19.04675706943909,17.756038438230455,16.83443385460527,16.95563548216998,18.05589441291978,17.053226403066244,17.96459968046844,17.213779208411708,17.146095182628816,18.316399209828347,16.82735064260473,17.09651269862507,18.177883064040106,16.848600278606337,17.08549436884646,17.078411156845924,19.102635741887756,17.109892099070525,17.01466224884111,17.224797538190316,18.39195347116739,17.280676210638983,16.978459165282818,18.210151029820324,17.75367736756361,17.406599979537386,17.07919818040154,17.250769315525613,17.398729743981235,17.136650899961438,18.394314541834238,16.893460621276397,17.072114968401003,17.74738117911869,18.258946490268453,16.917071327944846,17.29248156397321,17.15947458307427,16.904478951055005,17.075263062623463,17.83946293512565,17.18151124263149,16.96980190617105,17.0351248612871,17.75367736756361,17.120910428849136,17.065818779956086,17.912656125797845,17.751316296896764,17.374332013757172,17.25785252752615,17.382202249313323,17.362526660422947,17.349934283533106,18.06061655425347,17.310583105752357,17.380628202202093,17.471135911097818,17.754464391119225,17.596272656440608,17.435719851095143,17.57659706755023,17.331045718198347,17.432571756872683,17.729279637339545,17.50733899465611,17.429423662650223,17.32081441197535,17.630114669332052,17.637984904888203,17.66238263511227,17.80955604001228,17.736362849340082,17.59863372710745,17.449886275096212,17.547477195992474,17.740297967118156,17.559282549326703,17.97640503380266,17.412896167982307,17.768630815120297,17.792241521788746,17.938627903133142,17.636410857776973,17.6324757399989,17.673400964890877,17.80089878090051,17.653725376000505,17.639558951999433,17.671826917779647,17.585254326661996,17.62067038666467,17.737936896451313,17.78043616845452,17.667104776445957,18.089736425811225,17.8945545840187,17.79617663956682,17.77886212134329,17.779649144898908,17.882749230684475,17.996867646248653,17.948859209356137,18.027561564917637,17.83474079379196,17.91973933779838,17.801685804456127,17.758399508897302,17.95436837424544,17.806407945789818,17.860712571127255,17.80719496934543,17.810343063567892,17.806407945789818,17.93547980891068,17.928396596910147,17.904785890241694,17.876453042239554,17.9260355262433,17.841824005792493,17.938627903133142,18.026774541362023];
  const C = [16.20481501011325,14.286051581523834,16.586521434586537,19.060136469884544,17.098873769291913,17.6954376244481,16.85647051416249,17.496320664877498,17.43493282753953,17.14845625329566,17.552199337326165,19.162449532114493,17.224010514634703,19.01291505654764,17.16655779507481,19.16323655567011,17.106744004848064,17.41997937998284,19.21832820456316,17.143734111961972,17.29090751686198,17.142160064850742,17.27201895152722,19.134903707667974,17.21535325552294,18.407693942279693,18.190475440929944,18.000802764026727,17.10438293418122,17.302712870196206,18.50292379250911,17.201186831521866,18.358111458275946,17.100447816403143,18.319547304050808,17.97168289246897,17.10280888706999,18.067699766254,17.32553655330904,17.96302563335721,17.102021863514373,18.532043664066865,18.044089059585552,18.364407646720863,17.222436467523472,17.35072130708872,17.149243276851276,17.8788141129064,17.4231274742053,19.19865261567279,18.942869960097905,17.401090814648082,17.272805975082832,18.531256640511252,17.886684348462552,17.497894711988728,19.03573873966048,17.169705889297266,17.778075097787678,18.60759792540591,17.16340970085235,17.469561863986588,17.32081441197535,17.367248801756638,17.319240364864118,17.80719496934543,17.597846703551838,17.865434712460946,17.250769315525613,17.057948544399935,17.266509786637915,17.51048708887857,17.299564775973746,18.097606661367376,18.1566334280385,17.402664861759312,17.36331368397856,17.95122028002298,17.575810043994615,17.48372828798766,18.284131244048137,17.6222444337759,17.621457410220287,18.19441055870802,17.536458866213867,17.774927003565217,17.686780365336336,17.555347431548626,17.503403876878036,17.69228953022564,17.79617663956682,17.45382139287429,17.51048708887857,17.645855140444354,17.53409779554702,17.567939808438464,17.489237452876967,17.879601136462014,17.63090169288767,17.68914143600318,17.479793170209586,17.90557291379731,17.50576494754488,17.79066747467752,17.910295055131,17.699372742226174,17.751316296896764,17.94807218580052,17.599420750663068,17.72219642533901,17.667104776445957,17.920526361353993,17.561643619993546,17.709604048449172,17.676549059113338,17.7269185666727,17.72219642533901,17.658447517334196,17.59863372710745,17.917378267131532,17.633262763554512,17.813491157790352,17.803259851567358,17.63404978711013,17.72062237822778,17.867008759572172,17.711965119116016,17.664743705779117,17.789880451121903,17.66080858800104,17.74580713200746,17.887471372018165,17.91973933779838,17.733214755117622,17.838675911570036,17.911869102242232,17.810343063567892,17.68756738889195,18.110199038257218,18.011034070249725,17.97955312802512,17.92760957335453,17.811917110679122,17.986636340025658,17.715900236894093,18.110199038257218,17.940988973799985,18.051959295141703,17.950433256467367,17.917378267131532];

  new uPlot({
  title: "Per-Base Sequence Content",
  width: 1000,
  height: 400,
  legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
  },
  series: [
    { label: "Position" },
    { label: "%A", stroke: "#1f77b4", width: 2, show: true },
    { label: "%T", stroke: "#d62728", width: 2, show: true },
    { label: "%G", stroke: "#2ca02c", width: 2, show: true },
    { label: "%C", stroke: "#ff7f0e", width: 2, show: true }
  ],
  axes: [
    { label: "Base Position", time: false, scale: "x", values: (u,t)=>t.map(v=>v.toFixed(0)) },
    { label: "Percentage", scale: "y", range: [0, 100] }
  ],
  cursor: { drag: { x: true, y: false } },
  hooks: {
    ready: [u => {
      u.root.addEventListener("dblclick", () => {
        u.setScale("x", null);
        u.setScale("y", null);
      });
    }]
  }
}, [basePos, A, T, G, C], document.getElementById("base-comp-plot"));

// Per-sequence quality histogram
const psqHist = {"50":1,"51":5,"52":14,"53":31,"54":88,"55":137,"56":177,"57":310,"58":513,"59":1225,"60":1410,"61":1171,"62":1376,"63":1935,"64":2355,"65":2536,"66":2954,"67":3398,"68":4095,"69":4743,"70":6054,"71":8252,"72":13283,"73":38896,"74":32102};
const psqBins = Object.entries(psqHist).map(([q, c]) => [parseInt(q), c]).sort((a, b) => a[0] - b[0]);
const xPSQ = psqBins.map(([q, _]) => q);
const yPSQ = psqBins.map(([_, c]) => c);

new uPlot({
  title: "Per-Sequence Quality Score Distribution",
  width: 1000,
  height: 400,
  legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
  },
  series: [
    { label: "Quality Score", value: (u, v) => `${v}` },
    {
      label: "Count",
      stroke: "darkorchid",
      width: 2,
      fill: "rgba(153, 50, 204, 0.3)",
      value: (u, v) => v.toFixed(0)
    }
  ],
  axes: [
    { label: "Average Quality", time: false, values: (u, vals) => vals.map(v => v.toFixed(0)) },
    { label: "Read Count" }
  ],
  cursor: { drag: { x: true, y: false } },
  hooks: {
    ready: [u => u.root.addEventListener("dblclick", () => u.setScale("x", null))]
  }
}, [xPSQ, yPSQ], document.getElementById("per-seq-quality-chart"));

const nContent = [0.43522402625510587,0.015740471112300394,0.0,0.0023610706668450586,0.006296188444920157,0.0031480942224600783,0.0,0.0,0.0,0.0,0.0,0.0007870235556150196,0.0,0.0,0.003935117778075098,0.0,0.0,0.0015740471112300391,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.010231306222995253,0.0015740471112300391,0.0,0.007083212000535175,0.0,0.0,0.0031480942224600783,0.007083212000535175,0.0,0.0,0.0,0.0,0.006296188444920157,0.0,0.0,0.0,0.0,0.0007870235556150196,0.0566656960042814,0.0,0.0,0.0,0.0,0.0,0.0,0.009444282667380234,0.0031480942224600783,0.008657259111765216,0.0,0.0015740471112300391,0.0,0.0015740471112300391,0.0023610706668450586,0.005509164889305137,0.0,0.0,0.0,0.003935117778075098,0.0015740471112300391,0.0,0.0,0.0,0.0,0.0,0.005509164889305137,0.0,0.0,0.0,0.0,0.003935117778075098,0.0,0.011805353334225293,0.0,0.0007870235556150196,0.005509164889305137,0.0,0.0007870235556150196,0.0031480942224600783,0.0,0.006296188444920157,0.0,0.006296188444920157,0.0,0.0,0.006296188444920157,0.0007870235556150196,0.005509164889305137,0.0007870235556150196,0.0,0.003935117778075098,0.0023610706668450586,0.0015740471112300391,0.0,0.01652749466791541,0.010231306222995253,0.015740471112300394,0.01731451822353043,0.010231306222995253,0.0023610706668450586,0.0015740471112300391,0.009444282667380234,0.0007870235556150196,0.0,0.0,0.007870235556150197,0.0007870235556150196,0.0,0.007870235556150197,0.0023610706668450586,0.003935117778075098,0.0007870235556150196,0.008657259111765216,0.004722141333690117,0.0007870235556150196,0.01416642400107035,0.01888856533476047,0.018101541779145452,0.0007870235556150196,0.009444282667380234,0.013379400445455334,0.009444282667380234,0.0023610706668450586,0.013379400445455334,0.010231306222995253,0.021249636001605527,0.0023610706668450586,0.003935117778075098,0.014953447556685371,0.021249636001605527,0.005509164889305137,0.010231306222995253,0.005509164889305137,0.021249636001605527,0.011018329778610274,0.008657259111765216,0.018101541779145452,0.010231306222995253,0.0,0.008657259111765216,0.010231306222995253,0.003935117778075098,0.011805353334225293,0.0031480942224600783,0.006296188444920157,0.012592376889840313];

new uPlot({
  title: "Per-Base N Content",
  width: 1000,
  height: 400,
  legend: {
    show: true,      // âœ… Enable clickable legend
    live: true       // âœ… Let it dynamically reflect toggles
  },
  series: [
    { label: "Position" },
    { label: "%N", stroke: "purple", width: 2, value: (u,v)=>v.toFixed(2) }
  ],
  axes: [
    { label: "Base Position", time: false, values: (u,t)=>t.map(v=>v.toFixed(0)) },
    { label: "% N", range: [0, 100] }
  ],
  cursor: { drag: { x: true, y: false } },
  hooks: { ready: [u => u.root.addEventListener("dblclick", () => u.setScale("x", null))] }
}, [basePos, nContent], document.getElementById("n-content-plot"));




</script>

</body>
</html>
